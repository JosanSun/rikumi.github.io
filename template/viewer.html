<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link rel="icon" type="image/png" sizes="80x80" href="/static/icons/favicon.png">
    <script src="https://cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script>
    <link href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet">
    <link href="/static/css/normalize.css" rel="stylesheet">
    <script src="/static/js/marked.js"></script>
    <link href="/static/css/markdown.css" rel="stylesheet">
    <script src="/static/js/highlight.js"></script>
    <link href="/static/css/highlight.css" rel="stylesheet">
    <link href="/static/css/viewer.css" rel="stylesheet">
    <title>{{ filename }}ä¸¨{{ config.title }}</title>
    <style> html, body { margin: 0; padding: 0; } </style>
    <script>
        $("body").ready(function() {
            var content = $("#content").html().replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&");
            console.log(content);
            marked.setOptions({
                renderer: new marked.Renderer(),
                gfm: true,
                tables: true,
                breaks: false,
                pedantic: false,
                sanitize: false,
                smartLists: false,
                smartypants: false
            });
            marked.setOptions({
                highlight: function (code, lang) {
                    if (lang == "") {
                        return hljs.highlightAuto(code).value;
                    }
                    return hljs.highlightAuto(code, [lang]).value;
                }
            });
            $("#content").html(marked(content));
            $("#content").attr("class", "markdown-body");
        });

        var menu = false;

        function toggleMenu() {
            menu = !menu;
            $("#content").css("margin-top", menu ? "120px" : "72px");
        }
    </script>
</head>
<body>
    <div id="sidebar" onselectstart="return false">
        <a href="/"><img class="avatar" ondragstart="return false" src="{{ config.avatar }}"></a>
        <div class="name">{{ config.nickname }}</div>
        <div class="profile">{{ config.intro }}</div>
        <div class="icon ion-more" onclick="toggleMenu()"></div>

        {% for item in config.sidebar %}
            <a class="link" href="{{ '/' + quote(str(item)) }}"><li>{{ item.split('/')[-1] }}</li></a>
        {% end %}

        <div class="footer">{{ config.footer }}</div>
    </div>
    <div id="content" class="markdown-body loading">
        {{ content }}
    </div>
</body>
</html>
